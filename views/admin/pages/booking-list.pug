extends ../layouts/default.pug

block main
  h1.box-title Quản lý đặt vé

  //- Section 4
  .section-4
    .inner-wrap
      .inner-item.inner-label
        <i class="fa-solid fa-filter"></i> Bộ lọc
      .inner-item.inner-date
        input(type="date" filter-start-date)
        span -
        input(type="date" filter-end-date)
      .inner-item.inner-reset(filter-reset)
        <i class="fa-solid fa-rotate-left"></i> Xóa bộ lọc
  //- End Section 4

  //- Section 5
  .section-5
    .inner-wrap
      .inner-search
        <i class="fa-solid fa-magnifying-glass"></i>
        input(type="text" placeholder="Tìm kiếm" search)
  //- End Section 5

  //- Section 6
  .section-6
    .table-2
      table
        thead
          tr
            th Mã đặt vé
            th Thông tin khách
            th Thông tin phim
            th Ghế & Combo
            th Thanh toán
            th Trạng thái
            th(class="inner-center") Ngày đặt
            th Hành động
        tbody
          each booking in bookingList
            tr
              td
                .inner-code #{booking.bookingCode}
              td
                div Họ tên: #{booking.fullName}
                div SĐT: #{booking.phone}
                if booking.email
                  div Email: #{booking.email}
                if booking.note
                  div Ghi chú: #{booking.note}
              td
                .inner-item
                  .inner-image
                    img(src=booking.movieAvatar, alt=booking.movieName)
                  .inner-content
                    .inner-name #{booking.movieName}
                    .inner-quantity Rạp: #{booking.cinema}
                    .inner-quantity Ngày: #{booking.showtimeDateFormat}
                    .inner-quantity Giờ: #{booking.showtime.time}
                    .inner-quantity Định dạng: #{booking.showtime.format}
              td
                div Ghế: #{booking.seats.map(s => s.seatNumber).join(', ')}
                if booking.combos && booking.combos.length > 0
                  div Combo:
                  each combo in booking.combos
                    div • #{combo.name} x#{combo.quantity}
                else
                  div Combo: Không có
              td
                div Tiền vé: #{(booking.subTotal || 0).toLocaleString("vi-VN")}đ
                div Tiền combo: #{(booking.comboTotal || 0).toLocaleString("vi-VN")}đ
                div Giảm: #{(booking.discount || 0).toLocaleString("vi-VN")}đ
                div Tổng: #{(booking.total || 0).toLocaleString("vi-VN")}đ
                div PTTT: #{booking.paymentMethodName}
                div TTTT: #{booking.paymentStatusName}
              td
                if (booking.status == "initial")
                  .badge.badge-orange #{booking.statusName}
                else if (booking.status == "confirmed")
                  .badge.badge-green #{booking.statusName}
                else if (booking.status == "cancelled")
                  .badge.badge-red #{booking.statusName}
                else if (booking.status == "completed")
                  .badge.badge-green #{booking.statusName}
              
              td(class="inner-center")
                div #{booking.createdAtTime}
                div #{booking.createdAtDate}
              td
                .inner-buttons
                  a(
                    href=`/${pathAdmin}/booking/edit/${booking._id}`
                    class="inner-edit"
                  ) <i class="fa-regular fa-pen-to-square"></i>
                  button(
                    button-delete 
                    class="inner-delete"
                    data-api=`/${pathAdmin}/booking/delete/${booking._id}`
                  ) <i class="fa-regular fa-trash-can"></i>
  //- End Section 6
  //- Section 7 - PHÂN TRANG
  .section-7
    span(class="inner-label") 
      | Hiển thị #{(pagination.currentPage - 1) * pagination.limit + 1} - #{pagination.endRecord} của #{pagination.totalRecords}
    select(class="inner-pagination" pagination)
      - for(let i = 1; i <= pagination.totalPages; i++)
        option(value=i selected=(i == pagination.currentPage)) Trang #{i}
  //- End Section 7