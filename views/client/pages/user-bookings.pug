extends ../layouts/default.pug

block main
  .section-12
    .container
      .inner-wrap
        h2.inner-title-main Đơn Đặt Vé Của Tôi
        
        if bookings.length > 0
          .inner-order-list
            each booking in bookings
              .inner-order-item
                .inner-order-header
                  .inner-order-code Mã: #{booking.bookingCode}
                  .inner-order-date #{booking.createdAtFormat}
                
                .inner-order-body
                  .inner-tour-item
                    .inner-image
                      img(src=booking.movieAvatar alt=booking.movieName)
                    .inner-content
                      .inner-name #{booking.movieName}
                      .inner-quantity Rạp: #{booking.cinema}
                      .inner-quantity Ngày chiếu: #{booking.showtimeDateFormat}
                      .inner-quantity Giờ chiếu: #{booking.showtime.time}
                      .inner-quantity Định dạng: #{booking.showtime.format}
                      .inner-quantity 
                        strong Ghế: 
                        | #{booking.seats.map(s => s.seatNumber).join(', ')}
                      
                      if booking.combos && booking.combos.length > 0
                        .inner-quantity
                          strong Combo:
                        each combo in booking.combos
                          .inner-quantity • #{combo.name} x#{combo.quantity}
                
                .inner-order-footer
                  .inner-total-info
                    div Tiền vé: #{(booking.subTotal || 0).toLocaleString("vi-VN")}đ
                    if booking.comboTotal > 0
                      div Tiền combo: #{(booking.comboTotal || 0).toLocaleString("vi-VN")}đ
                    div.total Tổng: #{(booking.total || 0).toLocaleString("vi-VN")}đ
                    div PTTT: #{booking.paymentMethodName}
                  
                  .inner-status
                    div
                      if booking.paymentStatus === 'paid'
                        span.badge.badge-green #{booking.paymentStatusName}
                      else
                        span.badge.badge-orange #{booking.paymentStatusName}
                    div
                      if booking.status === "confirmed" || booking.status === "completed"
                        span.badge.badge-green #{booking.statusName}
                      else if booking.status === "cancelled"
                        span.badge.badge-red #{booking.statusName}
                      else
                        span.badge.badge-orange #{booking.statusName}
        else
          p.text-center Bạn chưa có đơn đặt vé nào
        
        .inner-back
          a(href="/") Tiếp tục đặt vé

  style.
    .inner-order-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .inner-order-item {
      border: 1px solid #E0E0E0;
      border-radius: 8px;
      overflow: hidden;
      background: white;
    }
    
    .inner-order-header {
      background-color: #f8f8f8;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #E0E0E0;
    }
    
    .inner-order-code {
      font-weight: 600;
      font-size: 16px;
      color: var(--color-primary);
    }
    
    .inner-order-date {
      font-size: 14px;
      color: #666;
    }
    
    .inner-order-body {
      padding: 20px;
    }
    
    .inner-tour-item {
      display: flex;
      gap: 15px;
    }
    
    .inner-tour-item .inner-image {
      width: 120px;
      height: 160px;
      border-radius: 8px;
      overflow: hidden;
      flex-shrink: 0;
    }
    
    .inner-tour-item .inner-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .inner-tour-item .inner-content {
      flex: 1;
    }
    
    .inner-tour-item .inner-name {
      font-weight: 700;
      font-size: 18px;
      color: var(--color-primary);
      margin-bottom: 10px;
    }
    
    .inner-tour-item .inner-quantity {
      font-size: 14px;
      color: #666;
      margin-bottom: 5px;
      line-height: 1.5;
    }
    
    .inner-order-footer {
      background-color: #f8f8f8;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
    }
    
    .inner-total-info {
      display: flex;
      flex-direction: column;
      gap: 5px;
      font-size: 14px;
    }
    
    .inner-total-info .total {
      font-weight: 700;
      font-size: 16px;
      color: var(--color-primary);
      margin-top: 5px;
    }
    
    .inner-status {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .text-center {
      text-align: center;
      padding: 40px 0;
      color: #666;
    }
    
    @media (max-width: 767.98px) {
      .inner-order-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      
      .inner-order-footer {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .inner-tour-item {
        flex-direction: column;
      }
      
      .inner-tour-item .inner-image {
        width: 100%;
        height: 200px;
      }
      
      .inner-status {
        flex-direction: column;
        align-items: flex-start;
        width: 100%;
      }
    }